---
layout: post
title:  "物理层基本概念"
date:   2025-08-17 00:00:00
categories: NR
tags: 读书笔记
excerpt: 从数据链路层出发，经常接触到的一些物理层基本概念汇总
mathjax: true
---
* content
{:toc}
---

![KYHHbj.png](https://s2.ax1x.com/2019/10/23/KYHHbj.png)



> [博客地址](https://dufaxing.com){:target="_blank"}


## 0. 前言

- RE: Resource Element,资源元素,它是无线资源网格中一个最小的单位，由“1个OFDM符号”时长和“1个子载波”带宽唯一确定，是承载信息（如调制符号、参考信号）的物理实体。<br>
- RB：Resource Block - 资源块。是网络调度和分配资源的基本单位，通常由频域上12个连续的子载波和时域上1个时隙（例如14个OFDM符号）组成。<br>
- REG：Resource Element Group - 资源元素组。通常由同一OFDM符号上的几个连续RE组成，主要用于控制信道（如PDCCH）的映射。<br>
- CCE：Control Channel Element - 控制信道元素。由多个REG组成，是PDCCH传输的资源单位。<br>


## 1\. 核心概念与信号处理基础

    无线通信是共享媒介，所有用户都在相同的频段上通信。为了避免混乱，必须有一套极其精确的时域和频域规则来规定：什么时候发送？在哪个频率上发送？以什么格式发送？

### 1.1 **调制与编码**
    
-   **调制：** 将数字比特（你的数据）映射到模拟波形的过程。你必须熟悉 **QPSK, 16QAM, 64QAM, 256QAM** 甚至 **1024QAM**。理解不同调制方式的**星座图**，以及它们对信道质量的依赖（高阶调制需要更好的信噪比）。

-   **编码：** 为了对抗信道错误而添加冗余的过程。重点是 **LDPC码（5G数据信道）** 和 **Polar码（5G控制信道）**。理解**编码率**的概念，它决定了有效信息在总传输量中的占比。MAC层会根据物理层反馈的CQI来选择**MCS**，这直接关联了调制方式和编码率。

### 1.2**资源网格与帧结构**

#### 1.2.1 时域：

**帧 > 子帧 > 时隙 > 符号** 的分层时间结构。数据调度是以**时隙**或**微时隙**为基本单位的。
        

- **无线帧**
    
    -   **时长：** 10 ms
        
    -   **作用：** 最高层的时间基准。一个帧被分成10个**子帧**。
        
-  **子帧**
    -   **时长：** 1 ms
        
    -   **作用：** 在LTE中是调度的核心单位，在5G NR中其重要性下降，更多是作为一个时间参考（仪表中依然大量使用）。一个子帧可以包含1个或多个**时隙**。
        
- **时隙**
    - **时长：** **可变**的，这是5G相对于LTE的一个关键灵活性增强。
    - **组成：** 由**14个OFDM符号**（在常规循环前缀下）组成。
    - **可变性来源：** 时隙的长度取决于**子载波间隔**。
        - 子载波间隔越大，OFDM符号长度越短，一个时槽的持续时间也就越短。
        - 例如：SCS=15 kHz -> 时隙=1 ms | SCS=30 kHz -> 时隙=0.5 ms | SCS=60 kHz -> 时隙=0.25 ms
    - **作用：** **时隙是调度的核心时间单位之一**。MAC层调度器分配资源时，通常以时隙为基本单元（也可以更细，到微时隙）。
        
- **符号**
    - **时长：** 一个时隙长度的 1/14（加上循环前缀CP后的小 overhead）。
    - **作用：** **最小的时域单位**。每个符号上可以承载一个调制符号（如QPSK符号、QAM符号）。它是资源网格中的一个最小“时间格子”。

**时域关系总结：**  

`帧 (10ms) -> 子帧 (1ms) -> 时隙 (可变，含14个符号) -> 符号 (最小单位)`


#### 1.2.2频域

** 理解**载波带宽 > 资源块**的概念。一个**资源块**是频域上12个子载波、时域上1个时隙的基本调度单位。你分配的TB（传输块）最终会被映射到特定的RB上。

频域结构是从小到大定义的：

- **子载波**

    - **宽度：** **可变**的（15kHz, 30kHz, 60kHz, 120kHz, 240kHz）。<br>
    - **作用：** **最小的频域单位**。它是OFDM技术的基础，将宽频带划分成大量窄带的、相互正交的子信道。每个子载波独立地进行窄带调制，共同组合成高速数据流。它是资源网格中的一个最小“频率格子”。<br>
        
- **资源块**

    - **定义：** **频域上12个连续的子载波**。<br>
    - **作用：** **资源调度的核心频域单位**。这是MAC层调度器分配资源时最常用的基本块。当你听说“基站给某个UE分配了5个RB”时，意思就是在频域上分配了5\*12=60个子载波供其使用。
    - **带宽：** 一个RB的带宽 = 12 \* 子载波间隔。例如，SCS=30kHz时，1个RB的带宽是 12 \* 30kHz = 360kHz。
- **带宽部分**
    - **定义：** 载波带宽内的一组连续的RB集合。
    - **作用：** 这是5G引入的一个重要概念，允许一个UE不需要支持整个小区的大带宽，而只需要在其活动的BWP上进行收发，极大地节省了功耗。MAC层会参与BWP的适配和切换。

**频域关系总结：**  
`子载波 (最小单位) -> 资源块 (RB = 12子载波) -> 带宽部分 (BWP = N个RB) -> 载波带宽`

#### 1.2.3 资源网格：时域与频域的终极结合

现在我们把时域和频域结合起来，就得到了资源网格。

- 资源网格
    - 定义： 一个资源网格可以看作一个二维表格。
    - 横轴（时域）： 代表时间，以一个时隙内的OFDM符号为最小单位（最多14列）。
    - 纵轴（频域）： 代表频率，以子载波为最小单位。但为了简化，通常以资源块为单位来描述（即每12行作为一个单元）。

- 资源元素
    - 定义： 资源网格中的一个最小单元，即1个子载波 x 1个OFDM符号的交叉点。
    - 作用： 这是承载一个调制符号（如一个QPSK或64QAM符号）的物理实体。参考信号（DM-RS）、控制信息、数据最终都是映射到一个个RE上的。

- 资源元素组
    - 定义： 一组RE的集合（例如，频域上连续的几个RE）。
    - 作用： 主要用于映射控制信道信息，是比RE大一点的映射单位。

一个时隙的资源网格就像一个有很多行（子载波/资源块）和14列（符号）的Excel表格。每个小格子就是一个RE。MAC层决定的数据（传输块TB）经过信道编码和调制后，生成的大量调制符号，就像一串珍珠，被一颗一颗地按特定规则放入这个表格的格子里（资源映射）。

```
频域 (子载波索引，从低到高)
▲
│  ┌───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┬───┐
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │ 子载波 11
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │ 子载波 10
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
│  │   │   │   │   │   │   │   │   │   │   │   │   │   │ 子载波 1
│  ├───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┼───┤
└─►│   │   │   │   │   │   │   │   │   │   │   │   │   │   │ 子载波 0
   └───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┴───┘
   ◄────────────────────── 时域 (OFDM符号索引) ──────────────────────►
     符号0  符号1 符号2 ...                      ...  符号13
```

上图显示的整个12x14的网格，就是一个资源块.
- 频域上：它包含了12个连续的子载波（从子载波0到11）。
- 时域上：它占据了一个完整的时隙（14个符号）。
- 一个RB包含的RE数：12个子载波 * 14个符号 = 168个RE（在常规循环前缀下）。

特殊区域：
- 控制区域：通常，每个时隙的前几个符号（如符号0、1）可能用于传输PDCCH（下行控制信息）。这些符号上的RE就不能用来传数据。
- 参考信号：网格中会分散地、有规律地插入一些特定的RE来放置参考信号（如DM-RS），用于信道估计和解调。这些RE也被预先占用了。

#### 1.2.3 空域

理解**天线端口**和**层**的概念。这与MIMO技术强相关。

#### 1.2.4 总结

作为数据链路层开发者，可以简单理解为：MAC层生成的传输块，经过编码、调制后变成一串调制符号。物理层的工作就是根据MAC的指令，将这一串符号精准地映射到这个RE上（避开已被控制信息和参考信号占用的格子），然后通过天线发射出去。

## 2\. 物理信道与信号

数据链路层的PDU（协议数据单元）最终被送到了哪里。

### 2.1 物理数据信道
    
#### 2.1.1 PDSCH

**物理下行共享信道** ：这是承载下行用户数据（来自的RLC/MAC）的核心信道。主要处理流程：加扰、调制、层映射、预编码、资源映射等。

#### 2.1.2 PUSCH

**物理上行共享信道**：这是承载上行用户数据的核心信道。
        
### 2.2 物理控制信道

#### 2.2.1 PDCCH

**物理下行控制信道**：这是网络驱动UE的MAC层的主要的方式。因为它携带**DCI**，告诉UE在何处（时频资源）、以何种格式（MCS）、如何（HARQ信息）接收PDSCH或发送PUSCH。物理层需要持续监听PDCCH。

DCI：Downlink Control Information，这非常重要，作为数据链路层的开发者，最需要了解的是网络指示UE发送/接收数据时间点。

#####  K0：PDSCH时域资源分配偏移量

**定义**

-   **K0** 指的是从**承载DCI（下行授权）的PDCCH所在时隙**到**该DCI所调度的PDSCH（承载下行数据的共享信道）所在时隙**之间的时间偏移。
    
-   **单位是时隙（Slot）**。
    
-   **公式表示**：`PDSCH时隙 = PDCCH时隙 + K0`
    

**具体含义**：  
当UE在一个时隙（记为时隙 `n`）中成功解码出一个下行授权DCI后，这个DCI告诉UE：“我给你调度的下行数据，不在现在这个时隙，而是在未来的 `K0` 个时隙之后，也就是时隙 `n + K0` 中。”


**配置位置**

K0的值并非固定不变，也不是由DCI直接用一个数字字段指示的。它的配置机制更为灵活，涉及以下两层配置：

1.  **RRC高层信令配置（预定义表格）**：

    -   网络通过**RRC连接重配置消息**为UE配置一个或多个 **“PDSCH时域资源分配”表**。这个表是一个列表，其中包含了多行可能的时域参数组合，每一行都定义了一个 `K0` 值以及其他参数（如PDSCH的起始符号和持续长度）。
    - 在38.331协议中`RRCReconfiguration` -> `radioBearerConfig` -> `spCellConfig` -> `ServingCellConfig` -> `PDSCH-ServingCellConfig` -> `PDSCH-Config` -> **`pdsch-TimeDomainAllocationList`** 配置，格式如下：


```plaintext
PDSCH-TimeDomainResourceAllocation ::=   SEQUENCE {
    k0                                      INTEGER(0..32)                                                  OPTIONAL,   -- Need S
    mappingType                             ENUMERATED {typeA, typeB},
    startSymbolAndLength                    INTEGER (0..127)
}
```

2. **DCI动态指示（索引）**：

-   在具体的某个下行授权DCI（如DCI format 1\_0或1\_1）中，会包含一个名为 **“时域资源分配”** 的字段。这个字段本身**不是一个具体的K0数值**，而是一个**索引（Index）**。
    
-   UE收到DCI后，根据这个索引值，去查询网络通过RRC信令为其配置好的那个“PDSCH时域资源分配”表，从而找到对应的那一行，也就知道了本次传输的具体 `K0`、起始符号和持续时间。
    
-   **例如**：如果DCI中的“时域资源分配”字段指示索引为 `2`，UE查表得知 `K0 = 1`。这意味着UE将在当前PDCCH所在时隙的下一个时隙（`n+1`）接收PDSCH。

##### K2：PUSCH时域资源分配偏移量

#### **定义**

-   **K2** 指的是从**承载DCI（上行授权）的PDCCH所在时隙**到**该DCI所调度的PUSCH（承载上行数据的共享信道）所在时隙**之间的时间偏移。
    
-   **单位同样是时隙（Slot）**。
    
-   **公式表示**：`PUSCH时隙 = PDCCH时隙 + K2`
    

**具体含义**：  
当UE在一个时隙（时隙 `n`）中成功解码出一个上行授权DCI后，这个DCI告诉UE：“我允许你发送上行数据的时间，不是现在，而是在未来的 `K2` 个时隙之后，也就是时隙 `n + K2` 中。”

**配置位置**

K2的配置机制与K0完全类似，也采用“RRC配置表 + DCI动态索引”的方式：

1.  **RRC高层信令配置（预定义表格）**：
    
    -   网络通过**RRC信令**为UE配置一个 **“PUSCH时域资源分配”表**。这个表中的每一行同样定义了 `K2`、PUSCH的起始符号和持续长度等参数。

**DCI动态指示（索引）**：

-   在上行授权DCI（如DCI format 0\_0或0\_1）中，同样有一个 **“时域资源分配”** 字段。这个字段也是一个索引值。
    
-   UE根据这个索引，去查询配置好的“PUSCH时域资源分配”表，从而确定本次上行传输的具体 `K2` 值。
    
-   **例如**：如果DCI指示索引为 `3`，UE查表得知 `K2 = 4`。这意味着UE需要在收到DCI后的第4个时隙（`n+4`）才能发送PUSCH



#### 2.2.2 **PUCCH：**

**PUCCH** ：物理上行控制信道。用于携带**UCI**，包括至关重要的**HARQ-ACK/NACK**（告诉你发的数据包是否成功）、**CSI**（信道状态信息，用于链路自适应）。
        
### 2.2 **参考信号**

#### 2.2.1 CSI-RS

**CSI-RS** ：用于信道状态测量，UE据此计算CQI/RI/PMI并上报，这是选择MCS和MIMO层数的依据。

**DM-RS**： 解调参考信号，用于特定UE的特定PDSCH/PUSCH的解调。它与数据是预编码绑定的。

**SRS**： 探测参考信号，用于基站测量上行信道质量。
        

## 3\. 关键物理层过程

这些过程是数据链路层与物理层交互的核心。

-   **HARQ：**
    
    -   这是MAC层和物理层紧密协作的关键。理解**同步/异步、自适应/非自适应** HARQ。
        
    -   明确物理层负责HARQ软合并（Chase Combining或IR），而MAC层负责管理HARQ进程和生成ACK/NACK。
        
-   **链路自适应：**
    
    -   这是一个闭环过程：**UE测量CSI（基于CSI-RS） -> 上报CQI/PMI/RI -> 基站MAC调度器选择MCS -> 通过DCI下发 -> 物理层按此配置收发数据。**
        
    -   作为DL开发者，你需要理解CQI表格和MCS表格的映射关系，以及为什么信道质量差时会选择低阶调制和低编码率。
        
-   **MIMO：**
    
    -   理解**SU-MIMO**和**MU-MIMO**的基本原理。
        
    -   理解**预编码**、**传输层**、**码本**等概念。MAC层需要根据RI（秩指示）来决定同时传输的数据流数量。
        

## 4\. 测量与报告

物理层的测量结果是MAC层做出决策的“眼睛”。

-   **RSRP/RSRQ：** 主要用于小区选择和重选、切换，与初始接入和移动性管理相关。
    
-   **SINR：** 信干噪比，这是衡量信道质量的直接指标，与CQI和BLER（误块率）有直接关系。
    
-   **CQI：** 信道质量指示，是一个综合测量结果后的“建议”值，直接对应到一套MCS。





参考资料
[sharetechnote-NR帧结构](https://www.sharetechnote.com/html/5G/5G_FrameStructure.html)
[DCI_百度百科](https://baike.baidu.com/item/DCI/5804273)
