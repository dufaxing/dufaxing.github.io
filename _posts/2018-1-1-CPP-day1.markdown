---
layout: post
title:  "CPP基础与提高Day1"
date:   2018-1-1 00:00:00
categories: C++
tags: C++
excerpt: 新年要有新气象，重新学习一遍C++。
mathjax: true
---
* content
{:toc}
---

> C++对C 的扩展(Externsion).曾有人戏谑的说，C++作为一种面向对象的语言，名字起的不好，为什么呢？用c 的
语法来看，++ 操作符是post ++ 。

## 2.1.类型增强:

### 2.1.1.类型检查更严格

比如，把一个const 类型的指针赋给非const 类型的指针。c 语言中可以通的过，但是
在c++中则编不过去。<br/>
```
int main()
{
    const int a = 100;
    int b = a;
    const int *pa = &a;
    int *pb = pa;
    return 0;
}
```

### 2.1.2.布尔类型（bool）

c 语言的逻辑真假用0 和非0 来表示。而c++中有了具体的类型。<br/>
```
int main()
{
    bool flag = true;
    if(flag != false) {
        printf("i know bool type now\n");
    }
    printf("bool size = %d\n",sizeof(bool));
    return 0;
}
```

### 2.1.3.真正的枚举(enum)
c 语言中枚举本质就是整型，枚举变量可以用任意整型赋值。而c++中枚举变量，只能
用被枚举出来的元素初始化。<br/>
```
enum season {SPR,SUM,AUT,WIN};
int main()
{
    enum season s = SPR;
    s = 0;//error!!!
    return 0;
}
```

### 2.1.4. 表达式的值可被赋值
c 语言中表达式通常不能作为左值的，即不可被赋值，c++中某些表达式是可以赋值的。
比如：<br/>
```
#include <iostream>
using namespace std;
int main(void)
{
    int a,b = 5;
    (a = b) = 10;
    cout<<"a = "<<a<<" b = "<<b<<endl;
    (a<b? a:b) = 200;
    cout<<"a = "<<a<<" b = "<<b<<endl;
    return 0;
}
```
---

## 2.2.输入与输出(cin /cout)

- 第一个真正意义上的c++程序，c++程序的后缀名为cpp。假设程序名叫xxx 则应该写
成xxx.cpp。<br/>

### 2.2.1.cin && cout

cin 和cout 是C++的标准输入流和输出流。他们在头文件iostream 中定义。<br/>

|流名    |含义    |隐含设备|流名    |含义    |隐含设备|
|--------|--------|--------|--------|--------|--------|
|cin     |标准输入|键盘    |cerr    |标准错误|输出屏幕|
|cout    |标准输出|屏幕    |clog    |cerr缓冲|输出屏幕|

```
int main()
{
    char name[30];
    int age;
    cout<<"pls input name and age:"<<endl;
    cin>>name;
    cin>>age;
    // cin>>name>>age;
    cout<<"your name is: "<<name<<endl;
    cout<<"your age is: "<<age<<endl;
    return 0;
}
```

### 2.2.2.格式化

#### 2.2.2.1.设置域宽及位数

对于实型，cout 默认输出六位有效数据，setprecision(2) 可以设置有效位数，
setprecision(n)<<setiosflags(ios::fixed)合用，可以设置小数点右边的位数。<br/>

```
#include <iostream>
#include <iomanip>
using namespace std;
int main()
{
    printf("%c\n%d\n%f\n",'a',100,120.00);
    printf("%5c\n%5d\n%6.2f\n",'a',100,120.00);
    cout<<setw(5)<<'a'<<endl<<setw(5)<<100<<endl
    <<setprecision(2)<<setiosflags(ios::fixed)<<120.00<<endl;
    return 0;
}
```

#### 2.2.2.2.按进制输出

输出十进制，十六进制，八进制。默认输出十进制的数据。<br/>
```
int i = 123;
cout<<i<<endl;
cout<<dec<<i<<endl;
cout<<hex<<i<<endl;
cout<<oct<<i<<endl;
cout<<setbase(16)<<i<<endl;
```

#### 2.2.2.3.设置填充符

还可以设置域宽的同时，设置左右对齐及填充字符。<br/>
```
int main()
{
    cout<<setw(10)<<1234<<endl;
    cout<<setw(10)<<setfill('0')<<1234<<endl;
    cout<<setw(10)<<setfill('0')<<setiosflags(ios::left)<<1234<<endl;
    cout<<setw(10)<<setfill('-')<<setiosflags(ios::right)<<1234<<endl;
    return 0;
}
```

---

## 2.3.函数重载(function overload)

### 2.3.1.引例

如下函数分别求出整理数据和浮点型数据的绝对值:
```
int iabs(int a)
{
    return a>0? a:-a;
}
double fabs(double a)
{
    return a>0? a:-a;
}
```
C++ 致力于简化编程，能过函数重名来达到简化编程的目的。<br/>
```
int abs(int a)
{
    return a>0? a:-a;
}
double abs(double a)
{
    return a>0? a:-a;
}
```

### 2.3.2.重载规则与调用匹配（overload&match）
- 重载规则：<br/>
-- 1，函数名相同。<br/>
-- 2，参数个数不同，参数的类型不同，参数顺序不同，均可构成重载。<br/>
-- 3，返回值类型不同则不可以构成重载。<br/>
```
void func(int a); //ok
void func(char a); //ok
void func(char a,int b); //ok
void func(int a, char b); //ok
char func(int a); //与第一个函数有冲突，返还值不同。
```
有的函数虽然有返回值类型，但不与参数表达式运算，而作一条单独的语句。<br/>

- 匹配原则：
-- 1，严格匹配，找到则调用。<br/>
-- 2，通过隐式转换寻求一个匹配，找到则调用。<br/>

### 2.3.3.重载底层实现（name mangling）
- C++利用name mangling(倾轧)技术，来改名函数名，区分参数不同的同名函数。
实现原理：用v-c- i-f- l- d 表示void char int float long double 及其引用。<br/>

```
void func(char a); // func_c(char a)
void func(char a, int b, double c);
//func_cid(char a, int b, double c)
```
### 2.3.4.extern “C”
- extern "C"的主要作用就是为了能够正确实现C++代码调用其他C语言代码。加上extern "C"后，会指示编译器这部分代码按C语言的进行编译，而不是C++的。由于C++支持函数重载，因此编译器编译函数的过程中会将函数的参数类型也加到编译后的代码中，而不仅仅是函数名；而C语言并不支持函数重载，因此编译C语言代码的函数时不会带上函数的参数类型，一般之包括函数名。
比如说你用C 开发了一个DLL 库，为了能够让C ++语言也能够调用你的DLL输出(Export)的函数，你需要用extern "C"来强制编译器不要修改你的函数名。<br/>

### 2.4.操作符重载(operator overload)

前面用到的<<本身在c 语言中是位操作中的左移运算符。现在又用用流插入运算符，这
种一个字符多种用处的现像叫作重载。在c 语中本身就用重载的现像，比如& 既表示取地址，
又表示位操作中的与。*既表示解引用，又表示乘法运算符。只不过c 语言并没有开放重载机
制。<br/>
C++提供了运算符重载机制。可以为自定义数据类型重载运算符。实现构造数据类型也
可以像基本数据类型一样的运算特性。<br/>


---
