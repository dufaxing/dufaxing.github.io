<footer class="site-footer">
    <div class="wrapper">
        <p class="description">
            {% if site.description_footer %} {{site.description_footer}} {% endif %}
        </p>
        <p class="contact">
           Contact me at: 
            {% if site.github_username %}
            <a href="https://github.com/{{site.github_username}}" title="GitHub"><i class="fab fa-github" aria-hidden="true"></i></a> 
            {% endif %} 
            {% if site.email %}
            <a href="mailto:{{site.email}}" title="email"><i class="fas fa-envelope" aria-hidden="true"></i></a> 
            {% endif %} 
            {% if site.weibo_username %}
            <a href="http://weibo.com/{{site.weibo_username}}" title="Weibo"><i class="fab fa-weibo" aria-hidden="true"></i></a> 
            {% endif %} 
            {% if site.zhihu_username %}
            <a href="https://www.zhihu.com/people/{{site.zhihu_username}}" title="Zhihu"><i class="fab fa-zhihu" aria-hidden="true"></i></a> 
            {% endif %}
        </p>
        <p class="stats">
            <!-- 不蒜子统计 -->
            <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>           
            本站总访问量<span id="busuanzi_value_site_pv"><i class="fa fa-spinner fa-spin"></i></span>次，
            本站访客数<span id="busuanzi_value_site_uv"><i class="fa fa-spinner fa-spin"></i></span>人次，
            本文总阅读量<span id="busuanzi_value_page_pv"><i class="fa fa-spinner fa-spin"></i></span>次
        </p>
        <p class="power">
            <span>
                Site powered by <a href="https://jekyllrb.com/">Jekyll</a> & <a href="https://pages.github.com/">Github Pages</a>.
            </span>
            <span>
                Theme designed by <a href="https://github.com/dufaxing">dufaxing</a>.
            </span>
        </p>
    </div>
</footer>

<!-- jekyll 博客，重新封装了标签，导致无法识别mermaid。  -->
<!-- j使用Liquid标签包裹Mermaid代码，避免Jekyll处理。还可以用以下方式 -->
<!-- {% raw %} -->
<!--<div class="mermaid"> -->
<!--graph TD -->

<!--</div> -->
{<!--% endraw %} -->
<script>
document.addEventListener("DOMContentLoaded", function() {
  // 初始化Mermaid配置
  mermaid.initialize({
    startOnLoad: false, // 禁用自动初始化
    theme: 'default',
    flowchart: {
      useMaxWidth: true,
      htmlLabels: true,
      curve: 'basis'
    }
  });
  
  // 函数：提取代码内容
  function extractMermaidCode(block) {
    // 尝试多种可能的选择器
    var codeElement = block.querySelector('code');
    if (!codeElement) {
      // 尝试直接获取文本内容
      return block.textContent || block.innerText;
    }
    return codeElement.textContent;
  }
  
  // 处理所有可能的Mermaid代码块
  var mermaidSelectors = [
    '.language-mermaid',
    '.mermaid',
    'code.language-mermaid',
    'div.mermaid'
  ];
  
  var processed = false;
  
  mermaidSelectors.forEach(function(selector) {
    var blocks = document.querySelectorAll(selector);
    if (blocks.length > 0) {
      blocks.forEach(function(block) {
        // 跳过已经处理过的块
        if (block.getAttribute('data-mermaid-processed') === 'true') {
          return;
        }
        
        var code = extractMermaidCode(block);
        if (code && code.trim()) {
          // 创建新的Mermaid div
          var newDiv = document.createElement('div');
          newDiv.className = 'mermaid';
          newDiv.textContent = code;
          
          // 标记为已处理
          newDiv.setAttribute('data-mermaid-processed', 'true');
          
          // 替换原有元素
          block.parentNode.replaceChild(newDiv, block);
          processed = true;
        }
      });
    }
  });
  
  // 如果有处理过的图表，初始化Mermaid
  if (processed) {
    try {
      mermaid.init(undefined, '.mermaid');
    } catch (e) {
      console.error('Mermaid初始化错误:', e);
    }
  }
});
</script>

